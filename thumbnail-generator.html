<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AIverse ì¸ë„¤ì¼ ìƒì„±ê¸°</title>
    <style>
      body {
        font-family:
          'Pretendard',
          -apple-system,
          BlinkMacSystemFont,
          sans-serif;
        margin: 0;
        padding: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      .canvas-container {
        text-align: center;
        margin: 20px 0;
      }
      canvas {
        border: 2px solid #ddd;
        border-radius: 8px;
        max-width: 100%;
      }
      .controls {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }
      .control-group {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }
      label {
        font-weight: 600;
        color: #374151;
      }
      input,
      select {
        padding: 8px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 14px;
      }
      button {
        background: #6366f1;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        margin: 5px;
      }
      button:hover {
        background: #5856eb;
      }
      .preset-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin: 15px 0;
      }
      .preset-btn {
        background: #10b981;
        font-size: 14px;
        padding: 8px 16px;
      }
      .preset-btn:hover {
        background: #059669;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ¨ AIverse ì¸ë„¤ì¼ ìƒì„±ê¸°</h1>
      <p>ê°„ë‹¨í•˜ê²Œ ì¸ë„¤ì¼ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê³  ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!</p>

      <div class="controls">
        <div class="control-group">
          <label for="title">ì œëª©</label>
          <input
            type="text"
            id="title"
            value="ğŸ’• ë‚´ ì—°ì•  ìŠ¤íƒ€ì¼ í…ŒìŠ¤íŠ¸"
            placeholder="í…ŒìŠ¤íŠ¸ ì œëª©"
          />
        </div>
        <div class="control-group">
          <label for="description">ì„¤ëª…</label>
          <input
            type="text"
            id="description"
            value="MZì„¸ëŒ€ ì—°ì•  ë¬¸í™”ë¥¼ ë°˜ì˜í•œ ë‚˜ë§Œì˜ ì—°ì•  ìŠ¤íƒ€ì¼"
            placeholder="í…ŒìŠ¤íŠ¸ ì„¤ëª…"
          />
        </div>
        <div class="control-group">
          <label for="emoji">ì´ëª¨ì§€</label>
          <input type="text" id="emoji" value="ğŸ’•" placeholder="ğŸ¤–" maxlength="2" />
        </div>
        <div class="control-group">
          <label for="bgColorType">ë°°ê²½ìƒ‰ ì…ë ¥ ë°©ì‹</label>
          <select id="bgColorType" onchange="toggleColorInput()">
            <option value="picker">ìƒ‰ìƒ ì„ íƒê¸°</option>
            <option value="code">ìƒ‰ìƒ ì½”ë“œ ì…ë ¥</option>
          </select>
        </div>
        <div class="control-group" id="colorPickerGroup">
          <label for="bgColor">ë°°ê²½ìƒ‰</label>
          <input type="color" id="bgColor" value="#F56565" />
        </div>
        <div class="control-group" id="colorCodeGroup" style="display: none">
          <label for="bgColorCode">ë°°ê²½ìƒ‰ ì½”ë“œ</label>
          <input
            type="text"
            id="bgColorCode"
            value="#F56565"
            placeholder="#6366F1 ë˜ëŠ” rgb(99, 102, 241)"
          />
          <small style="color: #666; font-size: 12px"
            >ì˜ˆ: #6366F1, rgb(99, 102, 241), #FF0000</small
          >
        </div>
        <div class="control-group">
          <label for="showParticipants">ì°¸ì—¬ì ìˆ˜ í‘œì‹œ</label>
          <select id="showParticipants">
            <option value="true">í‘œì‹œ</option>
            <option value="false">ìˆ¨ê¹€</option>
          </select>
        </div>
        <div class="control-group" id="participantsGroup">
          <label for="participants">ì°¸ì—¬ì ìˆ˜</label>
          <input type="number" id="participants" value="45000" placeholder="45000" />
        </div>
      </div>

      <div class="preset-buttons">
        <button class="preset-btn" onclick="setPreset('love')">ğŸ’• ì—°ì•  ìŠ¤íƒ€ì¼</button>
        <button class="preset-btn" onclick="setPreset('ai')">ğŸ¤– AI ë¶„ì„</button>
        <button class="preset-btn" onclick="setPreset('mbti')">ğŸ§  MBTI</button>
        <button class="preset-btn" onclick="setPreset('kpop')">ğŸµ K-pop</button>
        <button class="preset-btn" onclick="setPreset('ott')">ğŸ“º OTT ì·¨í–¥</button>
      </div>

      <div style="text-align: center">
        <button onclick="generateImage()">ğŸ¨ ì´ë¯¸ì§€ ìƒì„±</button>
        <button onclick="downloadImage()">ğŸ’¾ ë‹¤ìš´ë¡œë“œ</button>
      </div>

      <div class="canvas-container">
        <canvas id="canvas" width="1200" height="630"></canvas>
      </div>
    </div>

    <script>
      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');

      const presets = {
        love: {
          title: 'ğŸ’• ë‚´ ì—°ì•  ìŠ¤íƒ€ì¼ í…ŒìŠ¤íŠ¸',
          description: 'MZì„¸ëŒ€ ì—°ì•  ë¬¸í™”ë¥¼ ë°˜ì˜í•œ ë‚˜ë§Œì˜ ì—°ì•  ìŠ¤íƒ€ì¼',
          emoji: 'ğŸ’•',
          bgColor: '#F56565',
          participants: 45000,
        },
        ai: {
          title: 'ğŸ¤– AI ì–¼êµ´ ë‚˜ì´ í…ŒìŠ¤íŠ¸',
          description: 'AIê°€ ë‹¹ì‹ ì˜ ì–¼êµ´ì„ ë¶„ì„í•´ì„œ ë‚˜ì´ë¥¼ ë§ì¶°ë³´ëŠ” í…ŒìŠ¤íŠ¸',
          emoji: 'ğŸ¤–',
          bgColor: '#6366F1',
          participants: 1200000,
        },
        mbti: {
          title: 'ğŸ’– MBTI ì—°ì•  ê¶í•© í…ŒìŠ¤íŠ¸',
          description: '16ê°€ì§€ MBTI ìœ í˜•ë³„ ìµœê³ ì˜ ì—°ì•  ê¶í•©',
          emoji: 'ğŸ’–',
          bgColor: '#8B5CF6',
          participants: 156000,
        },
        kpop: {
          title: 'ğŸµ K-pop ê·¸ë£¹ ìŠ¤íƒ€ì¼ í…ŒìŠ¤íŠ¸',
          description: 'ë‹¹ì‹ ê³¼ ê°€ì¥ ì˜ ë§ëŠ” K-pop ê·¸ë£¹ì€?',
          emoji: 'ğŸµ',
          bgColor: '#EC4899',
          participants: 89000,
        },
        ott: {
          title: 'ğŸ“º OTT ì·¨í–¥ ë¶„ì„ í…ŒìŠ¤íŠ¸',
          description: 'ë‹¹ì‹ ì˜ ì„±í–¥ì— ë§ëŠ” ì™„ë²½í•œ OTT ì½˜í…ì¸ ',
          emoji: 'ğŸ“º',
          bgColor: '#10B981',
          participants: 67000,
        },
      };

      function setPreset(type) {
        const preset = presets[type];
        document.getElementById('title').value = preset.title;
        document.getElementById('description').value = preset.description;
        document.getElementById('emoji').value = preset.emoji;

        // ë°°ê²½ìƒ‰ ì„¤ì •
        const colorType = document.getElementById('bgColorType').value;
        if (colorType === 'picker') {
          document.getElementById('bgColor').value = preset.bgColor;
        } else {
          document.getElementById('bgColorCode').value = preset.bgColor;
        }

        document.getElementById('participants').value = preset.participants;
        document.getElementById('showParticipants').value = 'true';
        toggleParticipantsInput();
        generateImage();
      }

      function toggleColorInput() {
        const colorType = document.getElementById('bgColorType').value;
        const pickerGroup = document.getElementById('colorPickerGroup');
        const codeGroup = document.getElementById('colorCodeGroup');

        if (colorType === 'picker') {
          pickerGroup.style.display = 'flex';
          codeGroup.style.display = 'none';
        } else {
          pickerGroup.style.display = 'none';
          codeGroup.style.display = 'flex';
        }
        generateImage();
      }

      function toggleParticipantsInput() {
        const showParticipants = document.getElementById('showParticipants').value;
        const participantsGroup = document.getElementById('participantsGroup');

        if (showParticipants === 'true') {
          participantsGroup.style.display = 'flex';
        } else {
          participantsGroup.style.display = 'none';
        }
        generateImage();
      }

      function getCurrentBgColor() {
        const colorType = document.getElementById('bgColorType').value;
        let bgColor;

        if (colorType === 'picker') {
          bgColor = document.getElementById('bgColor').value;
        } else {
          const colorCode = document.getElementById('bgColorCode').value.trim();
          bgColor = parseColorCode(colorCode);
        }

        return bgColor;
      }

      function parseColorCode(colorCode) {
        // HEX ì½”ë“œ (#RRGGBB ë˜ëŠ” #RGB)
        if (colorCode.startsWith('#')) {
          if (colorCode.length === 4) {
            // #RGBë¥¼ #RRGGBBë¡œ ë³€í™˜
            const r = colorCode[1];
            const g = colorCode[2];
            const b = colorCode[3];
            return `#${r}${r}${g}${g}${b}${b}`;
          } else if (colorCode.length === 7) {
            return colorCode;
          }
        }

        // RGB í˜•ì‹ (rgb(r, g, b))
        const rgbMatch = colorCode.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
        if (rgbMatch) {
          const r = parseInt(rgbMatch[1]).toString(16).padStart(2, '0');
          const g = parseInt(rgbMatch[2]).toString(16).padStart(2, '0');
          const b = parseInt(rgbMatch[3]).toString(16).padStart(2, '0');
          return `#${r}${g}${b}`;
        }

        // ê¸°ë³¸ê°’ ë°˜í™˜
        return '#6366F1';
      }

      function formatNumber(num) {
        if (num >= 1000000) return Math.floor(num / 100000) / 10 + 'M';
        if (num >= 1000) return Math.floor(num / 100) / 10 + 'K';
        return num.toString();
      }

      function adjustBrightness(hex, percent) {
        const num = parseInt(hex.replace('#', ''), 16);
        const amt = Math.round(2.55 * percent);
        const R = (num >> 16) + amt;
        const G = ((num >> 8) & 0x00ff) + amt;
        const B = (num & 0x0000ff) + amt;
        return (
          '#' +
          (
            0x1000000 +
            (R < 255 ? (R < 1 ? 0 : R) : 255) * 0x10000 +
            (G < 255 ? (G < 1 ? 0 : G) : 255) * 0x100 +
            (B < 255 ? (B < 1 ? 0 : B) : 255)
          )
            .toString(16)
            .slice(1)
        );
      }

      function generateImage() {
        const title = document.getElementById('title').value;
        const description = document.getElementById('description').value;
        const emoji = document.getElementById('emoji').value;
        const bgColor = getCurrentBgColor();
        const showParticipants = document.getElementById('showParticipants').value === 'true';
        const participants = parseInt(document.getElementById('participants').value) || 0;

        // ë°°ê²½ ê·¸ë¼ë””ì–¸íŠ¸
        const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
        gradient.addColorStop(0, bgColor);
        gradient.addColorStop(1, adjustBrightness(bgColor, -20));

        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // íŒ¨í„´ ì˜¤ë²„ë ˆì´
        ctx.save();
        ctx.globalAlpha = 0.1;
        ctx.fillStyle = '#FFFFFF';
        for (let x = 0; x < canvas.width; x += 60) {
          for (let y = 0; y < canvas.height; y += 60) {
            ctx.beginPath();
            ctx.arc(x, y, 2, 0, Math.PI * 2);
            ctx.fill();
          }
        }
        ctx.restore();

        // AIverse ë¡œê³ 
        ctx.fillStyle = '#FFFFFF';
        ctx.font = 'bold 48px -apple-system, BlinkMacSystemFont, sans-serif';
        ctx.textAlign = 'left';
        ctx.fillText('ğŸ¤– AIverse', 60, 80);

        // ë©”ì¸ ì´ëª¨ì§€
        ctx.font = '120px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(emoji, canvas.width / 2, 250);

        // ì œëª©
        ctx.fillStyle = '#FFFFFF';
        ctx.font = 'bold 64px -apple-system, BlinkMacSystemFont, sans-serif';
        ctx.textAlign = 'center';

        // ì œëª© ì¤„ë°”ê¿ˆ ì²˜ë¦¬
        const words = title.split(' ');
        let line = '';
        let y = 350;
        const maxWidth = canvas.width - 120;

        for (let i = 0; i < words.length; i++) {
          const testLine = line + words[i] + ' ';
          const metrics = ctx.measureText(testLine);

          if (metrics.width > maxWidth && i > 0) {
            ctx.fillText(line.trim(), canvas.width / 2, y);
            line = words[i] + ' ';
            y += 70;
          } else {
            line = testLine;
          }
        }
        ctx.fillText(line.trim(), canvas.width / 2, y);

        // ì„¤ëª…
        ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
        ctx.font = '32px -apple-system, BlinkMacSystemFont, sans-serif';
        ctx.textAlign = 'center';

        const descWords = description.split(' ');
        let descLine = '';
        let descY = y + 60;
        let lineCount = 0;
        const maxLines = 2;

        for (let i = 0; i < descWords.length && lineCount < maxLines; i++) {
          const testLine = descLine + descWords[i] + ' ';
          const metrics = ctx.measureText(testLine);

          if (metrics.width > maxWidth && i > 0) {
            ctx.fillText(descLine.trim(), canvas.width / 2, descY);
            descLine = descWords[i] + ' ';
            descY += 40;
            lineCount++;
          } else {
            descLine = testLine;
          }
        }

        if (lineCount < maxLines) {
          let finalLine = descLine.trim();
          if (descWords.length > 15) {
            finalLine += '...';
          }
          ctx.fillText(finalLine, canvas.width / 2, descY);
        }

        // ì°¸ì—¬ì ìˆ˜ (ì„ íƒì )
        if (showParticipants && participants > 0) {
          ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
          ctx.font = '28px -apple-system, BlinkMacSystemFont, sans-serif';
          ctx.textAlign = 'center';
          ctx.fillText(`ğŸ‘¥ ${formatNumber(participants)}ëª… ì°¸ì—¬`, canvas.width / 2, 570);
        }

        // ì¥ì‹ ìš”ì†Œë“¤
        const decorations = [
          { x: 100, y: 150, radius: 40, opacity: 0.1 },
          { x: canvas.width - 100, y: 200, radius: 30, opacity: 0.15 },
          { x: canvas.width - 80, y: canvas.height - 100, radius: 35, opacity: 0.1 },
          { x: 120, y: canvas.height - 120, radius: 25, opacity: 0.2 },
        ];

        decorations.forEach(decoration => {
          ctx.save();
          ctx.globalAlpha = decoration.opacity;
          ctx.fillStyle = '#FFFFFF';
          ctx.beginPath();
          ctx.arc(decoration.x, decoration.y, decoration.radius, 0, Math.PI * 2);
          ctx.fill();
          ctx.restore();
        });
      }

      function downloadImage() {
        const link = document.createElement('a');
        const title = document.getElementById('title').value;
        const filename =
          title
            .replace(/[^\w\s]/gi, '')
            .replace(/\s+/g, '-')
            .toLowerCase() + '.png';
        link.download = filename;
        link.href = canvas.toDataURL('image/png', 0.9);
        link.click();
      }

      // ì´ˆê¸° ì´ë¯¸ì§€ ìƒì„±
      generateImage();
    </script>
  </body>
</html>
